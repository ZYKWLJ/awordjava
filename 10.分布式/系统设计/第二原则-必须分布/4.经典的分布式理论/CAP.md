# CAP —— 旨在简洁地阐述分布式系统中一致性、可用性和分区容错性这三个基本特性之间的权衡关系

又称为帽子理论、布鲁尔理论

---
## 一、理论发展历程
 著名猜想：2000年提出，一致性(Consistency)、可用性(Availability)、分区容错(Partition-tolerance)三者无法在分布式系统中被同时满足，并且**最多只能满足其中两个**
 
 正式证明：2003年证明了这三者确实是不可兼得的。而后CAP被奉为分布式领域的重要理论，**被很多人当作分布式系统设计的金律**。

----
## 二、CAP三者定义
![alt text](../../../img/CAP三者定义.png)

 单个理论或事实
  C 一致性
  A 可用性，及可靠性
  P 网络固有属性，**是必选项**，因此**其实只有CP、AP理论**

## 三、发展与质疑

### 1.描述方式的质疑
  从C、A、P三个概念的本质来看，CAP理论的准确描述**不应该是从3个特性中选择2个**，因为**分区本身就是分布式集群固有的特性**，我们**只能被迫适应，根本没有选择权**!有人就此质疑，并且提出CAP理论应该这样描述:

---
### 2.具体两种实行方案
#### CP 
一些对数据一致性要求非常高的**金融系统**可能会更倾向于**选择一致性和分区容错性**

#### AP 
一些对**响应时间要求很高**的互联网应用可能会更倾向于**选择可用性和分区容错性**

### 3.时隔12年的修订
#### (1)背景
   面对铺天盖地的质疑，在CAP理论诞生 12年后，**CAP之父纷纷出来澄清**：

#### (2)论文大意
“3个中的2个”这个表述是不准确的，这个说法过于简化了复杂场景和问题领域；
#### 1.使用限制
把 CAP 理论的证明**局限在原子读写的场景**中，并声明不支持数据库事务之类的场景
#### 2.阐明分区
把分区容错归结为一个**对网络环境的陈述**，而非之前的一个独立条件。这实际上更加明确概念
#### 3.更加抽象
安全属性包含了一致性，活性包含了可用性，拓宽了CAP理论的研究范围

----
# 四、CAP总结
 是一个指导思想，但并不是一个**放之四海而皆准的普适性原理**，它仅适用于原子读写的NoSQL场景中，并不适合数据库系统。

## 为什么不适用于数据库系统？
CAP 理论旨在简洁地阐述分布式系统中一致性、可用性和分区容错性这三个基本特性之间的**权衡关系**。如果将事务纳入其中，事务的**ACID复杂特性**会使 CAP 理论的**核心权衡变得模糊**，难以清晰地表达和证明三者之间的本质关系。

未来的CAP
 现在分布式系统有很多特性，比如扩展性、自动化等。作为架构师的我们，在进行系统设计和开发时，视野要更加开拓，而不仅仅局限在CAP 问题上。