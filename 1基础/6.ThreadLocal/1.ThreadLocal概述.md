ThreadLocal的作用与使用方法

# 一、ThreadLocal的作用：
### 1.线程隔离(最大作用)
ThreadLocal 类提供了线程局部变量，它为**每个使用该变量的线程都提供一个独立的变量副本**，每个线程都可以**独立地改变自己的副本，而不会影响其他线程所对应的副本**。

### 2.提升性能(缓存线程信息的作用)
对于一些创建成本较高的对象，如**数据库连接**、SimpleDateFormat 等，如果**每个线程都频繁地创建和销毁这些对象**，会带来较大的性能开销。使用 ThreadLocal 可以**为每个线程缓存一个这样的对象**，线程在需要使用时直接从 ThreadLocal 中获取，**避免了重复创建对象的开销**，从而提高了性能。


# 二、Thread Local的方法：

```java
1.threadLocal.set(T value) // 设置线程内初始化实例对象

2.threadLocal.get() // 获取线程内该实例对象

3.threadLocal.remove() // 移除线程内实例对象
```

# 三、ThreadLocal使用注意点：

 1. 初始化线程中对象(重写protect的initialValue()方法)，**防止空指针异常**，方便设置对象属性值， 因为它默认是返回的空；

 2. 不能用来存储大的对象，防止溢出

 3. 使用**private static final进行修饰**，防止**多实例时内存泄漏**的问题

 4. 分布式环境**不能用ThreadLocal直接传递参数，因为不是同一个JVM**；


---
# 四、场景模拟：

我们模拟同时**有100个人发起请求访问某接口**，然后**输出100次租户id和租户name**，即100个线程做同一件事情。

事先分析：每个租户都有自己的id和名称，各自独立。最后我们输出租户id和租户名,为了方便演示我们租户名用“杨+线程id”表示。

