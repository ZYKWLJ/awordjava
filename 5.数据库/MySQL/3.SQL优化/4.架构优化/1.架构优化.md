# 一、背景

 项目业务数据逐渐增多，或业务发展比较迅速

  单表的数据量达**1000W或20G**以后

 优化已解决不了性能问题(主从读写分离、查询索引..)

 IO瓶颈(磁盘IO、网络IO)、CPU瓶颈(聚合查询、连接数太多)

# 二、架构优化

## (一)主从同步，读写分离架构=>集群=分片集群！
### 1.背景
  在许多高并发、高负载的应用场景中，对数据库的读写性能和可用性有很高的要求。单个 MySQL 数据库实例可能会面临以下问题：

  单机mysql
  
   单个访问压力大
  
   故障容错率低
 
 ---
### 2.主从同步原理
 #### ①主库
  
   负责接收写操作（INSERT、UPDATE、DELETE 等），并将这些操作记录到**二进制日志（Binary Log）中**(只记录修改！)。

   二进制日志记录了**数据库的变更操作**，可以被从库用来进行数据同步。
  
 #### ②从库
  
   配置连接到主库，并通过一个 I/O 线程从主库获取二进制日志。

   然后使用另一个线程（SQL 线程）将获取到的二进制日志中的操作**在从库上重新执行**，从而实现数据的同步。
 

----
### 3.读写分离架构=>主写从读
  
####  ①客户端实现（应用程序）

   对于写操作（通常是对数据的修改和插入），**将请求发送到主库**。

   对于读操作，可以根据**一定的策略将请求分发到一个或多个从库上**。

---
####  ②中间件实现

   有些场景下会**使用数据库中间件作为应用程序与数据库中间的桥梁**，来自动将读写请求分发到相应的主库或从库上，对应用程序隐藏了底层数据库架构的复杂性。